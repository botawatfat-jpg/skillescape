# GTM Integration - ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ๐

## ๐ ะัััััะน ััะฐัั

**ะัะต ัะฐะฑะพัะฐะตั ะธะท ะบะพัะพะฑะบะธ!** ะัะพััะพ ะทะฐะฟัััะธัะต `yarn dev` ะธ ะฟัะพะนะดะธัะต ะบะฒะธะท.

### ะะฐ 2 ะผะธะฝััั:
```bash
# 1. ะะฐะฟัััะธัั
yarn dev

# 2. ะัะบัััั ะบะพะฝัะพะปั (F12)

# 3. ะัะพะนัะธ ะบะฒะธะท
# ะฃะฒะธะดะธัะต ะฒ ะบะพะฝัะพะปะธ:
# [GTM DataLayer] { event: "quiz_cta_click", ... }
# [GTM DataLayer] { event: "quiz_start", ... }
# [GTM DataLayer] { event: "quiz_progress", ... }
```

---

## ๐ ะะพะบัะผะตะฝัะฐัะธั

### ๐ฏ ะัะฝะพะฒะฝัะต ัะฐะนะปั (ัะธัะฐะน ะฒ ััะพะผ ะฟะพััะดะบะต):

1. **[GTM_QUICK_START.md](./GTM_QUICK_START.md)** โญ ะะะงะะ ะะะะกะฌ
   - ะงัะพ ัะถะต ัะฐะฑะพัะฐะตั
   - ะะฐะบ ะฟัะพะฒะตัะธัั ะทะฐ 2 ะผะธะฝััั
   - ะงัะพ ะฝะฐัััะพะธัั ะฒ GTM
   - ะจะฟะฐัะณะฐะปะบะฐ ะบะพะผะฐะฝะด

2. **[GTM_CLEAN_FUNNEL.md](./GTM_CLEAN_FUNNEL.md)** โญ ะะะะะ
   - ะัะธััะฐะปัะฝะพ ัะธััะฐั ะฒะพัะพะฝะบะฐ
   - ะัะต ัะพะฑััะธั ะธ ะฟะฐัะฐะผะตััั
   - ะัะธะผะตัั ะฒะพัะพะฝะพะบ ะดะปั GA4
   - ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ะพะฟัะธะผะธะทะฐัะธะธ

3. **[GTM_IMPROVEMENTS_SUMMARY.md](./GTM_IMPROVEMENTS_SUMMARY.md)**
   - ะงัะพ ะฑัะปะพ ะธัะฟัะฐะฒะปะตะฝะพ
   - ะะพัะตะผั ััะพ ะฒะฐะถะฝะพ
   - ะะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั
   - ะกะปะตะดัััะธะต ัะฐะณะธ

### ๐ ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั:

4. **[GTM_TRACKING_MAP.md](./GTM_TRACKING_MAP.md)**
   - ะะดะต ะบะฐะบะธะต ัะตะณะธ ัััะฐะฝะพะฒะปะตะฝั
   - ะะฐัะฐะผะตััั ะฒัะตั ัะพะฑััะธะน
   - ะะดะต ะะ ัััะฐะฝะพะฒะปะตะฝั ัะตะณะธ (ะธ ะฟะพัะตะผั)

5. **[GTM_QUIZ_RESULTS.md](./GTM_QUIZ_RESULTS.md)**
   - ะะฐะบ ัะฐะฑะพัะฐะตั quiz_result_view
   - ะัะต ะฟะฐัะฐะผะตััั ะบะฒะธะทะฐ ะฒ JSON
   - ะัะธะผะตัั ัะตะณะผะตะฝัะฐัะธะธ ะฒ GTM
   - ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

6. **[TESTING_GTM_EVENTS.md](./TESTING_GTM_EVENTS.md)**
   - ะะฐะบ ัะตััะธัะพะฒะฐัั ัะพะฑััะธั
   - GTM Preview Mode
   - GA4 Real-time reports
   - Troubleshooting

7. **[GTM_FUTURE_IMPROVEMENTS.md](./GTM_FUTURE_IMPROVEMENTS.md)**
   - ะะพะทะผะพะถะฝัะต ัะปัััะตะฝะธั (ะฝะต ััะพัะฝะพ)
   - ะัะธะพัะธัะตัั
   - ะะพะณะดะฐ ััะพ ะดะตะปะฐัั

### ๐๏ธ ะะปั ัะฐะทัะฐะฑะพััะธะบะพะฒ:

8. **[src/shared/lib/analytics/GTM_USAGE_GUIDE.md](./src/shared/lib/analytics/GTM_USAGE_GUIDE.md)**
   - ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั `useAnalytics` hook
   - API Reference
   - TypeScript ัะธะฟั
   - ะัะธะผะตัั ะบะพะดะฐ

9. **[src/shared/lib/analytics/EXAMPLES.tsx](./src/shared/lib/analytics/EXAMPLES.tsx)**
   - Ready-to-use ะฟัะธะผะตัั
   - Quiz flow
   - Lead forms
   - Purchase flow
   - Custom events

### ๐ ะะฑัะฐั ะธะฝัะพัะผะฐัะธั:

10. **[ANALYTICS_SETUP.md](./ANALYTICS_SETUP.md)**
    - ะะพะปะฝัะน ะพะฑะทะพั ะธะฝัะตะณัะฐัะธะธ
    - ะะพะฝัะธะณััะฐัะธั
    - ะัะต ะดะพัััะฟะฝัะต ัะพะฑััะธั

11. **[SEO_AND_ANALYTICS_SUMMARY.md](./SEO_AND_ANALYTICS_SUMMARY.md)**
    - ะะฑะทะพั SEO + Analytics ัะฐะฑะพัั
    - ะงัะพ ัะดะตะปะฐะฝะพ
    - Pending tasks

---

## ๐ฏ ะะพัะพะฝะบะฐ ัะพะฑััะธะน

```
Homepage
   โ (user clicks "Take Quiz")
quiz_cta_click
   โ
quiz_start (pageId=1)
   โ
quiz_progress (10%, 25%, 50%, 75%, 100%)
   โ
lead_submit (email capture)
   โ
quiz_result_view (ะฒัะต ะดะฐะฝะฝัะต ะบะฒะธะทะฐ)
   โ
plan_view (selling page)
   โ
plan_cta_click
```

---

## โ ะงัะพ ัะถะต ัะฐะฑะพัะฐะตั

- โ **ะงะธััะฐั ะฒะพัะพะฝะบะฐ** - ะบะฐะถะดะพะต ัะพะฑััะธะต ะธะผะตะตั ัะตัะบะพะต ะฝะฐะทะฝะฐัะตะฝะธะต
- โ **ะะพะปะฝะฐั ะฐััะธะฑััะธั** - quiz_id ะฒะตะทะดะต ะณะดะต ะฝัะถะฝะพ
- โ **ะะตะดัะฟะปะธะบะฐัะธั** - ัะพะฑััะธั ะฝะต ะดัะฑะปะธัััััั
- โ **ะะพะณะฐััะต ะดะฐะฝะฝัะต** - quiz_result_view ะพัะฟัะฐะฒะปัะตั ะฒะตัั JSON
- โ **SSR-safe** - ะฒัะต ัะฐะฑะพัะฐะตั ั Next.js App Router
- โ **TypeScript** - ะฟะพะปะฝะฐั ัะธะฟะธะทะฐัะธั

---

## ๐ ะกะพะฑััะธั (ะฒัะต)

### Core Events:
1. **`quiz_cta_click`** - ะบะปะธะบ ะฟะพ CTA ะบะฝะพะฟะบะต
2. **`quiz_start`** - ััะฐัั ะฟัะพัะพะถะดะตะฝะธั (ัะพะปัะบะพ pageId=1)
3. **`quiz_progress`** - ะฟัะพะณัะตัั ะบะฒะธะทะฐ (0-100%)
4. **`quiz_result_view`** - ะฟัะพัะผะพัั ัะตะทัะปััะฐัะฐ + ะฒัะต ะดะฐะฝะฝัะต
5. **`lead_submit`** - email ะทะฐัะฒะฐัะตะฝ

### Additional Events:
6. **`button_click`** - ะปัะฑะพะน ะบะปะธะบ ะฟะพ ะบะฝะพะฟะบะต
7. **`form_submit`** - ะพัะฟัะฐะฒะบะฐ ัะพัะผั
8. **`plan_view`** - ะฟัะพัะผะพัั selling page
9. **`plan_cta_click`** - ะบะปะธะบ ะฝะฐ ะบะฝะพะฟะบั ะฟะพะบัะฟะบะธ

---

## ๐๏ธ GTM Setup (ััะพ ะฝัะถะฝะพ ะฝะฐัััะพะธัั)

### 1. ะะตัะตะผะตะฝะฝัะต (Data Layer Variables):
- `quiz_id`
- `cta_text`
- `cta_location`
- `progress_percent`
- `lead_type`
- `user_goal`
- `user_status`
- `income_goal`
- `coding_level`
- `has_email`
- ... ะธ ะดััะณะธะต

### 2. ะขัะธะณะณะตัั (Custom Events):
- `quiz_cta_click`
- `quiz_start`
- `quiz_progress`
- `quiz_result_view`
- `lead_submit`

### 3. ะขะตะณะธ (GA4 Events):
- Quiz CTA Click โ GA4
- Quiz Start โ GA4
- Quiz Progress โ GA4
- Quiz Result โ GA4
- Lead Submit โ GA4

**ะะตัะฐะปะธ:** ัะผ. [GTM_QUICK_START.md](./GTM_QUICK_START.md)

---

## ๐ฅ ะกะปะตะดัััะธะต ัะฐะณะธ

### 1. ะขะตััะธัะพะฒะฐะฝะธะต (ัะตะนัะฐั)
```bash
yarn dev
# ะัะบัััั ะบะพะฝัะพะปั
# ะัะพะนัะธ ะบะฒะธะท
# ะัะพะฒะตัะธัั ัะพะฑััะธั
```

### 2. GTM Setup (1-2 ัะฐัะฐ)
- ะกะพะทะดะฐัั ะฟะตัะตะผะตะฝะฝัะต
- ะกะพะทะดะฐัั ััะธะณะณะตัั
- ะกะพะทะดะฐัั ัะตะณะธ
- ะัะพัะตััะธัะพะฒะฐัั ะฒ Preview Mode

### 3. GA4 Explorations (1 ัะฐั)
- ะกะพะทะดะฐัั Core Funnel
- ะกะพะทะดะฐัั Drop-off Analysis
- ะกะพะทะดะฐัั Lead Quality Segmentation

### 4. ะะฐะบะพะฟะธัั ะดะฐะฝะฝัะต (1-2 ะฝะตะดะตะปะธ)
- ะะดะตะผ ะธ ัะพะฑะธัะฐะตะผ ััะฐัะธััะธะบั

### 5. ะะฝะฐะปะธะท ะธ ะพะฟัะธะผะธะทะฐัะธั (ongoing)
- ะะดะต drop-off?
- ะะฐะบะธะต CTA ัะฐะฑะพัะฐัั?
- ะะฐะบะธะต ะฟะพะปัะทะพะฒะฐัะตะปะธ ัะตะฝะฝะตะต?

---

## ๐ ะะพะดะดะตัะถะบะฐ

### ะงัะพ-ัะพ ะฝะต ัะฐะฑะพัะฐะตั?

1. **ะัะพะฒะตัะธัั ะบะพะฝัะพะปั** - ะฒัะต ัะพะฑััะธั ะปะพะณะธัััััั ะฒ dev mode
2. **ะัะพะฒะตัะธัั dataLayer** - `window.dataLayer` ะฒ ะบะพะฝัะพะปะธ
3. **ะัะธััะธัั session** - `sessionStorage.clear()`
4. **ะัะพัะธัะฐัั** [TESTING_GTM_EVENTS.md](./TESTING_GTM_EVENTS.md)

### GTM ะฝะต ะฟะพะบะฐะทัะฒะฐะตั ัะพะฑััะธั?

1. **GTM Preview Mode** - ะฟัะพะฒะตัะธัั ััะพ ัะตะณะธ ััะฐะฑะฐััะฒะฐัั
2. **GA4 DebugView** - ะฒะบะปััะธัั ะธ ะฟะพัะผะพััะตัั ัะพะฑััะธั
3. **ะัะพะฒะตัะธัั** ััะพ GTM ID ะฟัะฐะฒะธะปัะฝัะน (`GTM-T3S2P2LK`)

### โ๏ธ CSP ะฑะปะพะบะธััะตั GTM? (Content Security Policy)

**ะัะธะฑะบะฐ:** `violates the following Content Security Policy directive`

**ะะตัะตะฝะธะต:**
1. โ CSP ัะถะต ะฝะฐัััะพะตะฝ ะฒ `next.config.ts`
2. **ะะตัะตะทะฐะฟัััะธัั dev ัะตัะฒะตั** (`yarn dev`)
3. **ะัะธััะธัั ะบะตั ะฑัะฐัะทะตัะฐ** (Hard Reload)
4. **ะัะพัะธัะฐัั** [CSP_GTM_FIX.md](./CSP_GTM_FIX.md) ะดะปั ะดะตัะฐะปะตะน

---

## ๐ ะะพะด ะฟัะธะผะตัั

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะบะพะผะฟะพะฝะตะฝัะต:

```typescript
"use client";

import { useAnalytics } from "@/shared/lib/analytics";

export function MyComponent() {
  const { trackEvent, trackLeadSubmit } = useAnalytics();

  const handleClick = () => {
    trackEvent("button_click", {
      button_name: "My Button",
      location: "/my-page"
    });
  };

  const handleSubmit = () => {
    trackLeadSubmit("my_form", "ai_quiz_v1");
  };

  return (
    <button onClick={handleClick}>Click me</button>
  );
}
```

**ะะพะปััะต ะฟัะธะผะตัะพะฒ:** [src/shared/lib/analytics/EXAMPLES.tsx](./src/shared/lib/analytics/EXAMPLES.tsx)

---

## ๐ ะฃัะพะฒะตะฝั ัะตะฐะปะธะทะฐัะธะธ

**ะะตัะดะธะบั:** ะกะธะปัะฝัะน ะฟัะพะดัะบัะพะฒัะน ะธะฝะถะตะฝะตั โญ

**ะงัะพ ัะดะตะปะฐะฝะพ ะฝะฐ ะฒััะพะบะพะผ ััะพะฒะฝะต:**
- โ ะงะธััะฐั ะฐััะธัะตะบัััะฐ ัะพะฑััะธะน
- โ ะัะฐะฒะธะปัะฝะฐั ะดะตะดัะฟะปะธะบะฐัะธั
- โ ะะพะปะฝะฐั ะฐััะธะฑััะธั
- โ ะะพัะพะฒะฝะพััั ะบ ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธั
- โ ะัะปะธัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

**ะงัะพ ะผะพะถะฝะพ ัะปัััะธัั (ะฝะต ััะพัะฝะพ):**
- Server-Side Tracking (ััะตะฑัะตั backend)
- Enhanced Conversions (ะบะพะณะดะฐ ะทะฐะฟัััะธัะต ัะตะบะปะฐะผั)
- ะฃะฟัะพััะธัั quiz_progress (ะผะธะปะตััะพัะฝั)

**ะะตัะฐะปะธ:** [GTM_FUTURE_IMPROVEMENTS.md](./GTM_FUTURE_IMPROVEMENTS.md)

---

## ๐ ะะพะฝัะฐะบัั

**GTM ID:** GTM-T3S2P2LK  
**ะกัะฐััั:** โ ะะกะ ะะะะะขะะะข  
**ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 18 ัะฝะฒะฐัั 2026

---

## ๐บ๏ธ ะะฐะฒะธะณะฐัะธั ะฟะพ ะดะพะบัะผะตะฝัะฐัะธะธ

```
GTM_README.md (ัั ะทะดะตัั)
โ
โโโ ๐ ะัััััะน ััะฐัั
โ   โโโ GTM_QUICK_START.md
โ
โโโ ๐ฏ ะะพะฝััั ะฒะพัะพะฝะบั
โ   โโโ GTM_CLEAN_FUNNEL.md
โ
โโโ ๐ ะะตัะฐะปะธ
โ   โโโ GTM_TRACKING_MAP.md
โ   โโโ GTM_QUIZ_RESULTS.md
โ   โโโ TESTING_GTM_EVENTS.md
โ
โโโ ๐๏ธ ะะปั ัะฐะทัะฐะฑะพััะธะบะพะฒ
โ   โโโ src/shared/lib/analytics/GTM_USAGE_GUIDE.md
โ   โโโ src/shared/lib/analytics/EXAMPLES.tsx
โ
โโโ ๐ ะะตะทะพะฟะฐัะฝะพััั
โ   โโโ CSP_GTM_FIX.md (Content Security Policy ะดะปั GTM)
โ
โโโ ๐ ะัะดััะตะต
โ   โโโ GTM_FUTURE_IMPROVEMENTS.md
โ
โโโ ๐ ะะตะทัะผะต
    โโโ GTM_IMPROVEMENTS_SUMMARY.md
```

---

**ะะฐัะฝะธ ั [GTM_QUICK_START.md](./GTM_QUICK_START.md) โ ะะพัะพะผ [GTM_CLEAN_FUNNEL.md](./GTM_CLEAN_FUNNEL.md) โ ะะพัะพะผ ะพััะฐะปัะฝะพะต ะฟะพ ะฝะตะพะฑัะพะดะธะผะพััะธ**

๐ **Happy Tracking!**
